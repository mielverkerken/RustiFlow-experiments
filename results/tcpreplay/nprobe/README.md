```sh
mverkerk@node0:~/RustiFlow-experiments$ ./replay_run.sh nprobe eno3 300 192.168.0.2
Running test for nprobe with results in /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe...
Starting realtime performance test with following stats:
Date: 2025-02-23 18:37:10
CPU Cores: 16
CPU Logical Cores: 32
Total Memory: 47.09809112548828 GB
Available Memory: 44.57390594482422 GB

Running flow exporter on interface eno3...
Running with all iperf3 throughputs

Starting test with throughput: 1
Executing CMD: ['nprobe', '-i', 'eno3', '-n', 'none', '-t', '3600', '-d', '120', '--csv-separator', ',', '-P', '/users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe', '-V', '9', '--unprivileged-user', 'mverkerk', '-T', '%IPV4_SRC_ADDR %IPV4_DST_ADDR %L4_SRC_PORT %L4_DST_PORT %PROTOCOL %L7_PROTO %IN_BYTES %OUT_BYTES %IN_PKTS %OUT_PKTS %FLOW_DURATION_MILLISECONDS %TCP_FLAGS %CLIENT_TCP_FLAGS %SERVER_TCP_FLAGS %DURATION_IN %DURATION_OUT %MIN_TTL %MAX_TTL %LONGEST_FLOW_PKT %SHORTEST_FLOW_PKT %MIN_IP_PKT_LEN %MAX_IP_PKT_LEN %SRC_TO_DST_SECOND_BYTES %DST_TO_SRC_SECOND_BYTES %RETRANSMITTED_IN_BYTES %RETRANSMITTED_IN_PKTS %RETRANSMITTED_OUT_BYTES %RETRANSMITTED_OUT_PKTS %SRC_TO_DST_AVG_THROUGHPUT %DST_TO_SRC_AVG_THROUGHPUT %NUM_PKTS_UP_TO_128_BYTES %NUM_PKTS_128_TO_256_BYTES %NUM_PKTS_256_TO_512_BYTES %NUM_PKTS_512_TO_1024_BYTES %NUM_PKTS_1024_TO_1514_BYTES %TCP_WIN_MAX_IN %TCP_WIN_MAX_OUT %ICMP_TYPE %ICMP_IPV4_TYPE %DNS_QUERY_ID %DNS_QUERY_TYPE %DNS_TTL_ANSWER %FTP_COMMAND_RET_CODE']
Starting tcpreplay server: ssh -t mverkerk@192.168.0.2 'exec sudo tcpreplay -i eno3 --duration=300 --mbps=1 --quiet /data/cicids2017/cicids2017-trunc.pcap > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/tcpreplay_server_nprobe_1.log 2>&1'...
Starting ifstat client: ifstat -i eno3 -n -t 1 > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/ifstat_client_nprobe_1.log 2>&1...
                                                                                                                                                  Starting tcpdump client: sudo tcpdump --immediate-mode --buffer-size=32768 --packet-buffered -n --interface=eno3 -s 64 -w /dev/null > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/tcpdump_nprobe_1.log 2>&1...
                                                         Waiting for server to finish in 300 seconds...
                                                                                                       Process ID: 340462
                                                                                                                         Server finished.
Stopping exporter...
Waiting for exporter to finish...
Exporter finished.
Finished after 301.2770884037018s

Starting test with throughput: 10
Executing CMD: ['nprobe', '-i', 'eno3', '-n', 'none', '-t', '3600', '-d', '120', '--csv-separator', ',', '-P', '/users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe', '-V', '9', '--unprivileged-user', 'mverkerk', '-T', '%IPV4_SRC_ADDR %IPV4_DST_ADDR %L4_SRC_PORT %L4_DST_PORT %PROTOCOL %L7_PROTO %IN_BYTES %OUT_BYTES %IN_PKTS %OUT_PKTS %FLOW_DURATION_MILLISECONDS %TCP_FLAGS %CLIENT_TCP_FLAGS %SERVER_TCP_FLAGS %DURATION_IN %DURATION_OUT %MIN_TTL %MAX_TTL %LONGEST_FLOW_PKT %SHORTEST_FLOW_PKT %MIN_IP_PKT_LEN %MAX_IP_PKT_LEN %SRC_TO_DST_SECOND_BYTES %DST_TO_SRC_SECOND_BYTES %RETRANSMITTED_IN_BYTES %RETRANSMITTED_IN_PKTS %RETRANSMITTED_OUT_BYTES %RETRANSMITTED_OUT_PKTS %SRC_TO_DST_AVG_THROUGHPUT %DST_TO_SRC_AVG_THROUGHPUT %NUM_PKTS_UP_TO_128_BYTES %NUM_PKTS_128_TO_256_BYTES %NUM_PKTS_256_TO_512_BYTES %NUM_PKTS_512_TO_1024_BYTES %NUM_PKTS_1024_TO_1514_BYTES %TCP_WIN_MAX_IN %TCP_WIN_MAX_OUT %ICMP_TYPE %ICMP_IPV4_TYPE %DNS_QUERY_ID %DNS_QUERY_TYPE %DNS_TTL_ANSWER %FTP_COMMAND_RET_CODE']
Starting tcpreplay server: ssh -t mverkerk@192.168.0.2 'exec sudo tcpreplay -i eno3 --duration=300 --mbps=10 --quiet /data/cicids2017/cicids2017-trunc.pcap > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/tcpreplay_server_nprobe_10.log 2>&1'...
Starting ifstat client: ifstat -i eno3 -n -t 1 > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/ifstat_client_nprobe_10.log 2>&1...
                                                                                                                                                   Starting tcpdump client: sudo tcpdump --immediate-mode --buffer-size=32768 --packet-buffered -n --interface=eno3 -s 64 -w /dev/null > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/tcpdump_nprobe_10.log 2>&1...
                                                           Waiting for server to finish in 300 seconds...
                                                                                                         Process ID: 340480
                                                                                                                           Server finished.
Stopping exporter...
Waiting for exporter to finish...
Exporter finished.
Finished after 301.236704826355s

Starting test with throughput: 100
Executing CMD: ['nprobe', '-i', 'eno3', '-n', 'none', '-t', '3600', '-d', '120', '--csv-separator', ',', '-P', '/users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe', '-V', '9', '--unprivileged-user', 'mverkerk', '-T', '%IPV4_SRC_ADDR %IPV4_DST_ADDR %L4_SRC_PORT %L4_DST_PORT %PROTOCOL %L7_PROTO %IN_BYTES %OUT_BYTES %IN_PKTS %OUT_PKTS %FLOW_DURATION_MILLISECONDS %TCP_FLAGS %CLIENT_TCP_FLAGS %SERVER_TCP_FLAGS %DURATION_IN %DURATION_OUT %MIN_TTL %MAX_TTL %LONGEST_FLOW_PKT %SHORTEST_FLOW_PKT %MIN_IP_PKT_LEN %MAX_IP_PKT_LEN %SRC_TO_DST_SECOND_BYTES %DST_TO_SRC_SECOND_BYTES %RETRANSMITTED_IN_BYTES %RETRANSMITTED_IN_PKTS %RETRANSMITTED_OUT_BYTES %RETRANSMITTED_OUT_PKTS %SRC_TO_DST_AVG_THROUGHPUT %DST_TO_SRC_AVG_THROUGHPUT %NUM_PKTS_UP_TO_128_BYTES %NUM_PKTS_128_TO_256_BYTES %NUM_PKTS_256_TO_512_BYTES %NUM_PKTS_512_TO_1024_BYTES %NUM_PKTS_1024_TO_1514_BYTES %TCP_WIN_MAX_IN %TCP_WIN_MAX_OUT %ICMP_TYPE %ICMP_IPV4_TYPE %DNS_QUERY_ID %DNS_QUERY_TYPE %DNS_TTL_ANSWER %FTP_COMMAND_RET_CODE']
Starting tcpreplay server: ssh -t mverkerk@192.168.0.2 'exec sudo tcpreplay -i eno3 --duration=300 --mbps=100 --quiet /data/cicids2017/cicids2017-trunc.pcap > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/tcpreplay_server_nprobe_100.log 2>&1'...
Starting ifstat client: ifstat -i eno3 -n -t 1 > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/ifstat_client_nprobe_100.log 2>&1...
                                                                                                                                                    Starting tcpdump client: sudo tcpdump --immediate-mode --buffer-size=32768 --packet-buffered -n --interface=eno3 -s 64 -w /dev/null > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/tcpdump_nprobe_100.log 2>&1...
                                                             Waiting for server to finish in 300 seconds...
                                                                                                           Process ID: 340500
                                                                                                                             Server finished.
Stopping exporter...
Waiting for exporter to finish...
Exporter finished.
Finished after 301.28783798217773s

Starting test with throughput: 1000
Executing CMD: ['nprobe', '-i', 'eno3', '-n', 'none', '-t', '3600', '-d', '120', '--csv-separator', ',', '-P', '/users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe', '-V', '9', '--unprivileged-user', 'mverkerk', '-T', '%IPV4_SRC_ADDR %IPV4_DST_ADDR %L4_SRC_PORT %L4_DST_PORT %PROTOCOL %L7_PROTO %IN_BYTES %OUT_BYTES %IN_PKTS %OUT_PKTS %FLOW_DURATION_MILLISECONDS %TCP_FLAGS %CLIENT_TCP_FLAGS %SERVER_TCP_FLAGS %DURATION_IN %DURATION_OUT %MIN_TTL %MAX_TTL %LONGEST_FLOW_PKT %SHORTEST_FLOW_PKT %MIN_IP_PKT_LEN %MAX_IP_PKT_LEN %SRC_TO_DST_SECOND_BYTES %DST_TO_SRC_SECOND_BYTES %RETRANSMITTED_IN_BYTES %RETRANSMITTED_IN_PKTS %RETRANSMITTED_OUT_BYTES %RETRANSMITTED_OUT_PKTS %SRC_TO_DST_AVG_THROUGHPUT %DST_TO_SRC_AVG_THROUGHPUT %NUM_PKTS_UP_TO_128_BYTES %NUM_PKTS_128_TO_256_BYTES %NUM_PKTS_256_TO_512_BYTES %NUM_PKTS_512_TO_1024_BYTES %NUM_PKTS_1024_TO_1514_BYTES %TCP_WIN_MAX_IN %TCP_WIN_MAX_OUT %ICMP_TYPE %ICMP_IPV4_TYPE %DNS_QUERY_ID %DNS_QUERY_TYPE %DNS_TTL_ANSWER %FTP_COMMAND_RET_CODE']
Starting tcpreplay server: ssh -t mverkerk@192.168.0.2 'exec sudo tcpreplay -i eno3 --duration=300 --mbps=1000 --quiet /data/cicids2017/cicids2017-trunc.pcap > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/tcpreplay_server_nprobe_1000.log 2>&1'...
Starting ifstat client: ifstat -i eno3 -n -t 1 > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/ifstat_client_nprobe_1000.log 2>&1...
                                                                                                                                                     Starting tcpdump client: sudo tcpdump --immediate-mode --buffer-size=32768 --packet-buffered -n --interface=eno3 -s 64 -w /dev/null > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/tcpdump_nprobe_1000.log 2>&1...
                                                               Waiting for server to finish in 300 seconds...
                                                                                                             Process ID: 340519
                                                                                                                               Server finished.
Stopping exporter...
SIGINT failed, trying SIGTERM...
Waiting for exporter to finish...
Exporter finished.
Finished after 294.4139084815979s

Starting test with throughput: 10000
Executing CMD: ['nprobe', '-i', 'eno3', '-n', 'none', '-t', '3600', '-d', '120', '--csv-separator', ',', '-P', '/users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe', '-V', '9', '--unprivileged-user', 'mverkerk', '-T', '%IPV4_SRC_ADDR %IPV4_DST_ADDR %L4_SRC_PORT %L4_DST_PORT %PROTOCOL %L7_PROTO %IN_BYTES %OUT_BYTES %IN_PKTS %OUT_PKTS %FLOW_DURATION_MILLISECONDS %TCP_FLAGS %CLIENT_TCP_FLAGS %SERVER_TCP_FLAGS %DURATION_IN %DURATION_OUT %MIN_TTL %MAX_TTL %LONGEST_FLOW_PKT %SHORTEST_FLOW_PKT %MIN_IP_PKT_LEN %MAX_IP_PKT_LEN %SRC_TO_DST_SECOND_BYTES %DST_TO_SRC_SECOND_BYTES %RETRANSMITTED_IN_BYTES %RETRANSMITTED_IN_PKTS %RETRANSMITTED_OUT_BYTES %RETRANSMITTED_OUT_PKTS %SRC_TO_DST_AVG_THROUGHPUT %DST_TO_SRC_AVG_THROUGHPUT %NUM_PKTS_UP_TO_128_BYTES %NUM_PKTS_128_TO_256_BYTES %NUM_PKTS_256_TO_512_BYTES %NUM_PKTS_512_TO_1024_BYTES %NUM_PKTS_1024_TO_1514_BYTES %TCP_WIN_MAX_IN %TCP_WIN_MAX_OUT %ICMP_TYPE %ICMP_IPV4_TYPE %DNS_QUERY_ID %DNS_QUERY_TYPE %DNS_TTL_ANSWER %FTP_COMMAND_RET_CODE']
Starting tcpreplay server: ssh -t mverkerk@192.168.0.2 'exec sudo tcpreplay -i eno3 --duration=300 --mbps=10000 --quiet /data/cicids2017/cicids2017-trunc.pcap > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/tcpreplay_server_nprobe_10000.log 2>&1'...
Starting ifstat client: ifstat -i eno3 -n -t 1 > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/ifstat_client_nprobe_10000.log 2>&1...
                                                                                                                                                      Starting tcpdump client: sudo tcpdump --immediate-mode --buffer-size=32768 --packet-buffered -n --interface=eno3 -s 64 -w /dev/null > /users/mverkerk/RustiFlow-experiments/results/tcpreplay/nprobe/tcpdump_nprobe_10000.log 2>&1...
                                                                 Waiting for server to finish in 300 seconds...
                                                                                                               Process ID: 340537
                                                                                                                                 Server finished.
Stopping exporter...
SIGINT failed, trying SIGTERM...
Waiting for exporter to finish...
Exporter finished.
Finished after 175.31304216384888s
Test for nprobe completed successfully.
---------------------------------------------
```
